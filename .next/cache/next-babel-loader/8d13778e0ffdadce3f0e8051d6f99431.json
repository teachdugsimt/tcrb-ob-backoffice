{"ast":null,"code":"var _jsxFileName = \"/Users/admin/Desktop/tcrb-ob-project/tcrb-ob-backoffice-frontend/components/pending-approval/pending-approval.js\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useState, useEffect, useMemo } from 'react';\nimport ReactDOMServer from 'react-dom/server';\nimport { Table, Popconfirm, Row, Col } from 'antd';\nimport { inject, observer } from 'mobx-react';\nimport { DownOutlined } from '@ant-design/icons';\nimport { withTranslation } from '../../i18n';\nimport { CheckCircleOutlined, CloseCircleOutlined } from '@ant-design/icons';\nimport { TcrbSpin, TcrbPopconfirm } from '../antd-styles/styles';\nimport SimpleModal from '../simple-modal';\nimport styled from 'styled-components';\nimport moment from 'moment';\nimport { addKeyToDataSource } from '../data-utility';\nconst HoverIcon = styled(Col).withConfig({\n  displayName: \"pending-approval__HoverIcon\",\n  componentId: \"sc-1tne8uu-0\"\n})([\"color:green;cursor:pointer !important;\"]);\nconst HoverIconReject = styled(Col).withConfig({\n  displayName: \"pending-approval__HoverIconReject\",\n  componentId: \"sc-1tne8uu-1\"\n})([\"color:red;cursor:pointer !important;\"]);\nconst PendingApprovals = inject('pendingApprovalStore')(observer(props => {\n  const expand = {\n    expandedRowRender: record => __jsx(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 27,\n        columnNumber: 53\n      }\n    }, record.description)\n  };\n  const {\n    0: expandable,\n    1: setExpandable\n  } = useState(expand);\n  const {\n    0: hasData,\n    1: setHasData\n  } = useState(true);\n  const {\n    0: top,\n    1: setTop\n  } = useState('none');\n  const {\n    0: bottom,\n    1: setBottom\n  } = useState(\"bottomRight\");\n  const {\n    0: pendingApprovalData,\n    1: setPendingApprovalData\n  } = useState([]);\n  const {\n    0: title,\n    1: settitle\n  } = useState(\"Action details\");\n  const {\n    0: textOk,\n    1: settextOk\n  } = useState(\"Ok\");\n  const {\n    0: textCancel,\n    1: settextCancel\n  } = useState(\"Cancel\");\n  const {\n    0: modalString,\n    1: setmodalString\n  } = useState(\"initialState\");\n  const {\n    0: visible,\n    1: setvisible\n  } = useState(false);\n  const {\n    pendingApprovalStore,\n    t\n  } = props;\n\n  const renderTableData = data => {\n    const keys = Object.keys(data);\n    return ReactDOMServer.renderToStaticMarkup(__jsx(\"table\", {\n      style: {\n        border: 1\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 44,\n        columnNumber: 52\n      }\n    }, keys.map((k, index) => {\n      return __jsx(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 45,\n          columnNumber: 18\n        }\n      }, __jsx(\"td\", {\n        style: {\n          border: '1px solid lightgrey',\n          width: 200,\n          paddingLeft: 10,\n          backgroundColor: '#eeeeee'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 46,\n          columnNumber: 13\n        }\n      }, k), __jsx(\"td\", {\n        style: {\n          border: '1px solid lightgrey',\n          width: 200,\n          paddingLeft: 10\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 47,\n          columnNumber: 13\n        }\n      }, Array.isArray(data[k]) ? data[k].map(e => __jsx(\"div\", {\n        style: {\n          margin: 5,\n          padding: 3,\n          borderRadius: 3,\n          backgroundColor: 'lightgray'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 48,\n          columnNumber: 32\n        }\n      }, e.name)) : data[k]));\n    })));\n  };\n\n  const columns = [{\n    title: 'Ticket#',\n    dataIndex: 'id'\n  }, {\n    title: 'Request Type',\n    dataIndex: 'change_type'\n  }, {\n    title: 'Request Description',\n    key: 'description',\n    render: record => {\n      // console.table(record)\n      let data = JSON.parse(JSON.stringify(record));\n      let string = JSON.parse(data.data);\n      return __jsx(Row, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 20\n        }\n      }, __jsx(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 15\n        }\n      }, data.description ? `${data.description} ` : `${data.action}`), __jsx(\"div\", {\n        onClick: () => {\n          setmodalString(`\n                  <b>Action</b> : ${data.action}${' '}<br /><b>Request Type</b> : ${data.change_type}\n                  <div style=\"display: flex; flex-direction: row;\">\n                  <div style=\"flex:1;margin-right: 5px;\"><b>Current Value</b> : ${renderTableData(string.Current)}</div>\n                  <div style=\"flex:1;margin-left: 5px;\"><b>New Value</b>: ${renderTableData(string.New)}</div>\n                  </div>\n                `);\n          setvisible(true);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 15\n        }\n      }, __jsx(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 18\n        }\n      }, __jsx(\"a\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 24\n        }\n      }, \" : details\"))));\n    }\n  }, {\n    title: 'Request ID',\n    dataIndex: 'maker_id'\n  }, {\n    title: 'Request Date',\n    // dataIndex: 'requested_date',\n    key: 'requested_date',\n    render: record => {\n      let data = JSON.parse(JSON.stringify(record));\n      let date = moment(data.requested_date).format('LLL');\n      return __jsx(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 20\n        }\n      }, date);\n    }\n  }, {\n    title: 'Action',\n    key: 'action',\n    render: record => __jsx(Row, {\n      gutter: 16,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 13\n      }\n    }, __jsx(TcrbPopconfirm, {\n      title: \"Confirm to Approve !!!\",\n      onConfirm: () => processPending(\"APPROVE\", record),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 15\n      }\n    }, __jsx(HoverIcon, {\n      className: \"gutter-row\",\n      span: 6,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 17\n      }\n    }, __jsx(CheckCircleOutlined, {\n      height: \"1.5em\",\n      width: \"1.5em\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 19\n      }\n    }))), __jsx(TcrbPopconfirm, {\n      title: \"Confirm to Reject !!!\",\n      onConfirm: () => processPending(\"REJECT\", record),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 15\n      }\n    }, __jsx(HoverIconReject, {\n      className: \"gutter-row\",\n      span: 6,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 17\n      }\n    }, __jsx(CloseCircleOutlined, {\n      height: \"1.5em\",\n      width: \"1.5em\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 19\n      }\n    }))))\n  }];\n  useEffect(() => {\n    // call api\n    const data = {\n      filter: {}\n    };\n    pendingApprovalStore.getPendingApprove(data);\n  }, []);\n  useEffect(() => {\n    if (pendingApprovalStore.responseGetPendingApproveList && pendingApprovalStore.responseGetPendingApproveList.length > 0) {\n      addKeyToDataSource(pendingApprovalStore.responseGetPendingApproveList).then(result => {\n        //businessParametersSetupStore.arrayProductLimit = result\n        setPendingApprovalData(result);\n      });\n    }\n  }, [pendingApprovalStore.responseGetPendingApproveList]);\n\n  const processPending = (status, record) => {\n    let data = {\n      allowAction: status,\n      data: record,\n      id: record.id\n    };\n    pendingApprovalStore.setTmpPendingListID(record.id);\n    pendingApprovalStore.processPendingListApprove(data);\n  };\n\n  useEffect(() => {\n    if (pendingApprovalStore.tmpPendingListID && pendingApprovalStore.tmpPendingListID != null) {\n      if (pendingApprovalData && pendingApprovalData.length > 0) {\n        const list_all = JSON.parse(JSON.stringify(pendingApprovalData));\n        const old_data = pendingApprovalStore.tmpPendingListID;\n        list_all.map((e, i) => {\n          if (old_data == e.id) {\n            list_all.splice(i, 1);\n          }\n        });\n        setPendingApprovalData(list_all);\n      }\n    }\n  }, [pendingApprovalStore.tmpPendingListID]);\n\n  const _onConfirm = () => {\n    setvisible(false);\n  };\n\n  const _onCancel = () => {\n    setvisible(false);\n  };\n\n  const tableColumns = columns.map(item => _objectSpread({}, item));\n  return __jsx(TcrbSpin, {\n    spinning: pendingApprovalStore.apiLoading,\n    size: \"large\",\n    tip: \"Loading...\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 9\n    }\n  }, __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 11\n    }\n  }, __jsx(Col, {\n    span: 24,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 13\n    }\n  }, __jsx(Table, {\n    pagination: {\n      position: [top, bottom]\n    },\n    columns: tableColumns,\n    dataSource: pendingApprovalData // scroll={scroll}\n    ,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 15\n    }\n  }), __jsx(SimpleModal, {\n    title: title // type={modalType}\n    ,\n    onOk: () => _onConfirm(),\n    onCancel: () => _onCancel(),\n    textCancel: textCancel,\n    textOk: textOk,\n    width: 800,\n    modalString: modalString,\n    visible: visible,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 15\n    }\n  }))));\n}));\nexport default withTranslation('common')(PendingApprovals);","map":{"version":3,"sources":["/Users/admin/Desktop/tcrb-ob-project/tcrb-ob-backoffice-frontend/components/pending-approval/pending-approval.js"],"names":["React","useState","useEffect","useMemo","ReactDOMServer","Table","Popconfirm","Row","Col","inject","observer","DownOutlined","withTranslation","CheckCircleOutlined","CloseCircleOutlined","TcrbSpin","TcrbPopconfirm","SimpleModal","styled","moment","addKeyToDataSource","HoverIcon","HoverIconReject","PendingApprovals","props","expand","expandedRowRender","record","description","expandable","setExpandable","hasData","setHasData","top","setTop","bottom","setBottom","pendingApprovalData","setPendingApprovalData","title","settitle","textOk","settextOk","textCancel","settextCancel","modalString","setmodalString","visible","setvisible","pendingApprovalStore","t","renderTableData","data","keys","Object","renderToStaticMarkup","border","map","k","index","width","paddingLeft","backgroundColor","Array","isArray","e","margin","padding","borderRadius","name","columns","dataIndex","key","render","JSON","parse","stringify","string","action","change_type","Current","New","date","requested_date","format","processPending","filter","getPendingApprove","responseGetPendingApproveList","length","then","result","status","allowAction","id","setTmpPendingListID","processPendingListApprove","tmpPendingListID","list_all","old_data","i","splice","_onConfirm","_onCancel","tableColumns","item","apiLoading","position"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,EAAqCC,OAArC,QAAoD,OAApD;AACA,OAAOC,cAAP,MAA2B,kBAA3B;AACA,SAASC,KAAT,EAAgBC,UAAhB,EAA4BC,GAA5B,EAAiCC,GAAjC,QAA4C,MAA5C;AACA,SAASC,MAAT,EAAiBC,QAAjB,QAAiC,YAAjC;AACA,SAASC,YAAT,QAA6B,mBAA7B;AACA,SAASC,eAAT,QAAgC,YAAhC;AACA,SACEC,mBADF,EAEEC,mBAFF,QAGO,mBAHP;AAIA,SAASC,QAAT,EAAmBC,cAAnB,QAAyC,uBAAzC;AACA,OAAOC,WAAP,MAAwB,iBAAxB;AACA,OAAOC,MAAP,MAAmB,mBAAnB;AACA,OAAOC,MAAP,MAAmB,QAAnB;AACA,SAASC,kBAAT,QAAmC,iBAAnC;AACA,MAAMC,SAAS,GAAGH,MAAM,CAACV,GAAD,CAAT;AAAA;AAAA;AAAA,8CAAf;AAIA,MAAMc,eAAe,GAAGJ,MAAM,CAACV,GAAD,CAAT;AAAA;AAAA;AAAA,4CAArB;AAIA,MAAMe,gBAAgB,GACpBd,MAAM,CAAC,sBAAD,CAAN,CACGC,QAAQ,CAAEc,KAAD,IAAW;AACnB,QAAMC,MAAM,GAAG;AAAEC,IAAAA,iBAAiB,EAAEC,MAAM,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAIA,MAAM,CAACC,WAAX;AAA/B,GAAf;AACA,QAAM;AAAA,OAACC,UAAD;AAAA,OAAaC;AAAb,MAA8B7B,QAAQ,CAACwB,MAAD,CAA5C;AACA,QAAM;AAAA,OAACM,OAAD;AAAA,OAAUC;AAAV,MAAwB/B,QAAQ,CAAC,IAAD,CAAtC;AACA,QAAM;AAAA,OAACgC,GAAD;AAAA,OAAMC;AAAN,MAAgBjC,QAAQ,CAAC,MAAD,CAA9B;AACA,QAAM;AAAA,OAACkC,MAAD;AAAA,OAASC;AAAT,MAAsBnC,QAAQ,CAAC,aAAD,CAApC;AACA,QAAM;AAAA,OAACoC,mBAAD;AAAA,OAAsBC;AAAtB,MAAgDrC,QAAQ,CAAC,EAAD,CAA9D;AACA,QAAM;AAAA,OAACsC,KAAD;AAAA,OAAQC;AAAR,MAAoBvC,QAAQ,CAAC,gBAAD,CAAlC;AACA,QAAM;AAAA,OAACwC,MAAD;AAAA,OAASC;AAAT,MAAsBzC,QAAQ,CAAC,IAAD,CAApC;AACA,QAAM;AAAA,OAAC0C,UAAD;AAAA,OAAaC;AAAb,MAA8B3C,QAAQ,CAAC,QAAD,CAA5C;AACA,QAAM;AAAA,OAAC4C,WAAD;AAAA,OAAcC;AAAd,MAAgC7C,QAAQ,CAAC,cAAD,CAA9C;AACA,QAAM;AAAA,OAAC8C,OAAD;AAAA,OAAUC;AAAV,MAAwB/C,QAAQ,CAAC,KAAD,CAAtC;AACA,QAAM;AAAEgD,IAAAA,oBAAF;AAAwBC,IAAAA;AAAxB,MAA8B1B,KAApC;;AAIA,QAAM2B,eAAe,GAAIC,IAAD,IAAU;AAChC,UAAMC,IAAI,GAAGC,MAAM,CAACD,IAAP,CAAYD,IAAZ,CAAb;AACA,WAAOhD,cAAc,CAACmD,oBAAf,CAAoC;AAAO,MAAA,KAAK,EAAE;AAAEC,QAAAA,MAAM,EAAE;AAAV,OAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAA8BH,IAAI,CAACI,GAAL,CAAS,CAACC,CAAD,EAAIC,KAAJ,KAAc;AAC9F,aAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACL;AAAI,QAAA,KAAK,EAAE;AAAEH,UAAAA,MAAM,EAAE,qBAAV;AAAiCI,UAAAA,KAAK,EAAE,GAAxC;AAA6CC,UAAAA,WAAW,EAAE,EAA1D;AAA8DC,UAAAA,eAAe,EAAE;AAA/E,SAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAwGJ,CAAxG,CADK,EAEL;AAAI,QAAA,KAAK,EAAE;AAAEF,UAAAA,MAAM,EAAE,qBAAV;AAAiCI,UAAAA,KAAK,EAAE,GAAxC;AAA6CC,UAAAA,WAAW,EAAE;AAA1D,SAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAA4EE,KAAK,CAACC,OAAN,CAAcZ,IAAI,CAACM,CAAD,CAAlB,IAC1EN,IAAI,CAACM,CAAD,CAAJ,CAAQD,GAAR,CAAYQ,CAAC,IAAI;AAAK,QAAA,KAAK,EAAE;AAAEC,UAAAA,MAAM,EAAE,CAAV;AAAaC,UAAAA,OAAO,EAAE,CAAtB;AAAyBC,UAAAA,YAAY,EAAE,CAAvC;AAA0CN,UAAAA,eAAe,EAAE;AAA3D,SAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACdG,CAAC,CAACI,IADY,CAAjB,CAD0E,GAI1EjB,IAAI,CAACM,CAAD,CAJN,CAFK,CAAP;AAQD,KATwE,CAA9B,CAApC,CAAP;AAUD,GAZD;;AAcA,QAAMY,OAAO,GAAG,CACd;AACE/B,IAAAA,KAAK,EAAE,SADT;AAEEgC,IAAAA,SAAS,EAAE;AAFb,GADc,EAKd;AACEhC,IAAAA,KAAK,EAAE,cADT;AAEEgC,IAAAA,SAAS,EAAE;AAFb,GALc,EASd;AACEhC,IAAAA,KAAK,EAAE,qBADT;AAEEiC,IAAAA,GAAG,EAAE,aAFP;AAGEC,IAAAA,MAAM,EAAG9C,MAAD,IAAY;AAClB;AACA,UAAIyB,IAAI,GAAGsB,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAejD,MAAf,CAAX,CAAX;AACA,UAAIkD,MAAM,GAAGH,IAAI,CAACC,KAAL,CAAWvB,IAAI,CAACA,IAAhB,CAAb;AAEA,aAAO,MAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGA,IAAI,CAACxB,WAAL,GAAoB,GAAEwB,IAAI,CAACxB,WAAY,GAAvC,GAA6C,GAAEwB,IAAI,CAAC0B,MAAO,EAD9D,CADK,EAIL;AAAK,QAAA,OAAO,EAAE,MAAM;AAClBhC,UAAAA,cAAc,CAAE;oCACIM,IAAI,CAAC0B,MAAO,GAAE,GAAI,+BAA8B1B,IAAI,CAAC2B,WAAY;;kFAEnB5B,eAAe,CAAC0B,MAAM,CAACG,OAAR,CAAiB;4EACtC7B,eAAe,CAAC0B,MAAM,CAACI,GAAR,CAAa;;iBAJ1E,CAAd;AAOAjC,UAAAA,UAAU,CAAC,IAAD,CAAV;AACD,SATD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SASG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAAN,CATH,CAJK,CAAP;AAeD;AAvBH,GATc,EAkCd;AACET,IAAAA,KAAK,EAAE,YADT;AAEEgC,IAAAA,SAAS,EAAE;AAFb,GAlCc,EAsCd;AACEhC,IAAAA,KAAK,EAAE,cADT;AAEE;AACAiC,IAAAA,GAAG,EAAE,gBAHP;AAIEC,IAAAA,MAAM,EAAG9C,MAAD,IAAY;AAClB,UAAIyB,IAAI,GAAGsB,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAejD,MAAf,CAAX,CAAX;AACA,UAAIuD,IAAI,GAAG/D,MAAM,CAACiC,IAAI,CAAC+B,cAAN,CAAN,CAA4BC,MAA5B,CAAmC,KAAnC,CAAX;AACA,aAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACJF,IADI,CAAP;AAGD;AAVH,GAtCc,EAkDd;AACE3C,IAAAA,KAAK,EAAE,QADT;AAEEiC,IAAAA,GAAG,EAAE,QAFP;AAGEC,IAAAA,MAAM,EAAG9C,MAAD,IACN,MAAC,GAAD;AAAK,MAAA,MAAM,EAAE,EAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,MAAC,cAAD;AAAgB,MAAA,KAAK,EAAE,wBAAvB;AAAiD,MAAA,SAAS,EAAE,MAAM0D,cAAc,CAAC,SAAD,EAAY1D,MAAZ,CAAhF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,MAAC,SAAD;AAAW,MAAA,SAAS,EAAC,YAArB;AAAkC,MAAA,IAAI,EAAE,CAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,MAAC,mBAAD;AAAqB,MAAA,MAAM,EAAE,OAA7B;AAAsC,MAAA,KAAK,EAAE,OAA7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CADF,CADF,EAME,MAAC,cAAD;AAAgB,MAAA,KAAK,EAAE,uBAAvB;AAAgD,MAAA,SAAS,EAAE,MAAM0D,cAAc,CAAC,QAAD,EAAW1D,MAAX,CAA/E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,MAAC,eAAD;AAAiB,MAAA,SAAS,EAAC,YAA3B;AAAwC,MAAA,IAAI,EAAE,CAA9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,MAAC,mBAAD;AAAqB,MAAA,MAAM,EAAE,OAA7B;AAAsC,MAAA,KAAK,EAAE,OAA7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CADF,CANF;AAJJ,GAlDc,CAAhB;AAsEAzB,EAAAA,SAAS,CAAC,MAAM;AACd;AACA,UAAMkD,IAAI,GAAG;AACXkC,MAAAA,MAAM,EAAE;AADG,KAAb;AAGArC,IAAAA,oBAAoB,CAACsC,iBAArB,CAAuCnC,IAAvC;AACD,GANQ,EAMN,EANM,CAAT;AAQAlD,EAAAA,SAAS,CAAC,MAAM;AACd,QAAI+C,oBAAoB,CAACuC,6BAArB,IAAsDvC,oBAAoB,CAACuC,6BAArB,CAAmDC,MAAnD,GAA4D,CAAtH,EAAyH;AACvHrE,MAAAA,kBAAkB,CAAC6B,oBAAoB,CAACuC,6BAAtB,CAAlB,CAAuEE,IAAvE,CAA6EC,MAAD,IAAY;AACtF;AACArD,QAAAA,sBAAsB,CAACqD,MAAD,CAAtB;AACD,OAHD;AAID;AACF,GAPQ,EAON,CAAC1C,oBAAoB,CAACuC,6BAAtB,CAPM,CAAT;;AASA,QAAMH,cAAc,GAAG,CAACO,MAAD,EAASjE,MAAT,KAAoB;AACzC,QAAIyB,IAAI,GAAG;AACTyC,MAAAA,WAAW,EAAED,MADJ;AAETxC,MAAAA,IAAI,EAAEzB,MAFG;AAGTmE,MAAAA,EAAE,EAAEnE,MAAM,CAACmE;AAHF,KAAX;AAKA7C,IAAAA,oBAAoB,CAAC8C,mBAArB,CAAyCpE,MAAM,CAACmE,EAAhD;AACA7C,IAAAA,oBAAoB,CAAC+C,yBAArB,CAA+C5C,IAA/C;AACD,GARD;;AAUAlD,EAAAA,SAAS,CAAC,MAAM;AACd,QAAI+C,oBAAoB,CAACgD,gBAArB,IAAyChD,oBAAoB,CAACgD,gBAArB,IAAyC,IAAtF,EAA4F;AAC1F,UAAI5D,mBAAmB,IAAIA,mBAAmB,CAACoD,MAApB,GAA6B,CAAxD,EAA2D;AACzD,cAAMS,QAAQ,GAAGxB,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAevC,mBAAf,CAAX,CAAjB;AACA,cAAM8D,QAAQ,GAAGlD,oBAAoB,CAACgD,gBAAtC;AACAC,QAAAA,QAAQ,CAACzC,GAAT,CAAa,CAACQ,CAAD,EAAImC,CAAJ,KAAU;AACrB,cAAID,QAAQ,IAAIlC,CAAC,CAAC6B,EAAlB,EAAsB;AACpBI,YAAAA,QAAQ,CAACG,MAAT,CAAgBD,CAAhB,EAAmB,CAAnB;AACD;AACF,SAJD;AAKA9D,QAAAA,sBAAsB,CAAC4D,QAAD,CAAtB;AACD;AACF;AACF,GAbQ,EAaN,CAACjD,oBAAoB,CAACgD,gBAAtB,CAbM,CAAT;;AAeA,QAAMK,UAAU,GAAG,MAAM;AACvBtD,IAAAA,UAAU,CAAC,KAAD,CAAV;AACD,GAFD;;AAGA,QAAMuD,SAAS,GAAG,MAAM;AACtBvD,IAAAA,UAAU,CAAC,KAAD,CAAV;AACD,GAFD;;AAIA,QAAMwD,YAAY,GAAGlC,OAAO,CAACb,GAAR,CAAYgD,IAAI,sBAAUA,IAAV,CAAhB,CAArB;AAEA,SACE,MAAC,QAAD;AAAU,IAAA,QAAQ,EAAExD,oBAAoB,CAACyD,UAAzC;AAAqD,IAAA,IAAI,EAAC,OAA1D;AAAkE,IAAA,GAAG,EAAC,YAAtE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,GAAD;AAAK,IAAA,IAAI,EAAE,EAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,KAAD;AACE,IAAA,UAAU,EAAE;AAAEC,MAAAA,QAAQ,EAAE,CAAC1E,GAAD,EAAME,MAAN;AAAZ,KADd;AAEE,IAAA,OAAO,EAAEqE,YAFX;AAGE,IAAA,UAAU,EAAEnE,mBAHd,CAIA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAOE,MAAC,WAAD;AACE,IAAA,KAAK,EAAEE,KADT,CAEE;AAFF;AAGE,IAAA,IAAI,EAAE,MAAM+D,UAAU,EAHxB;AAIE,IAAA,QAAQ,EAAE,MAAMC,SAAS,EAJ3B;AAKE,IAAA,UAAU,EAAE5D,UALd;AAME,IAAA,MAAM,EAAEF,MANV;AAOE,IAAA,KAAK,EAAE,GAPT;AAQE,IAAA,WAAW,EAAEI,WARf;AASE,IAAA,OAAO,EAAEE,OATX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAPF,CADF,CADF,CADF;AAyBD,CAhLQ,CADX,CADF;AAoLA,eAAenC,eAAe,CAAC,QAAD,CAAf,CAA0BW,gBAA1B,CAAf","sourcesContent":["import React, { useState, useEffect, useMemo } from 'react'\nimport ReactDOMServer from 'react-dom/server'\nimport { Table, Popconfirm, Row, Col } from 'antd';\nimport { inject, observer } from 'mobx-react'\nimport { DownOutlined } from '@ant-design/icons';\nimport { withTranslation } from '../../i18n'\nimport {\n  CheckCircleOutlined,\n  CloseCircleOutlined,\n} from '@ant-design/icons';\nimport { TcrbSpin, TcrbPopconfirm } from '../antd-styles/styles'\nimport SimpleModal from '../simple-modal'\nimport styled from 'styled-components'\nimport moment from 'moment'\nimport { addKeyToDataSource } from '../data-utility'\nconst HoverIcon = styled(Col)`\n    color: green;\n    cursor: pointer !important;\n`\nconst HoverIconReject = styled(Col)`\n    color: red;\n    cursor: pointer !important;\n`\nconst PendingApprovals =\n  inject('pendingApprovalStore')\n    (observer((props) => {\n      const expand = { expandedRowRender: record => <p>{record.description}</p> };\n      const [expandable, setExpandable] = useState(expand)\n      const [hasData, setHasData] = useState(true)\n      const [top, setTop] = useState('none')\n      const [bottom, setBottom] = useState(\"bottomRight\")\n      const [pendingApprovalData, setPendingApprovalData] = useState([])\n      const [title, settitle] = useState(\"Action details\")\n      const [textOk, settextOk] = useState(\"Ok\")\n      const [textCancel, settextCancel] = useState(\"Cancel\")\n      const [modalString, setmodalString] = useState(\"initialState\")\n      const [visible, setvisible] = useState(false)\n      const { pendingApprovalStore, t } = props\n\n\n\n      const renderTableData = (data) => {\n        const keys = Object.keys(data)\n        return ReactDOMServer.renderToStaticMarkup(<table style={{ border: 1 }}>{keys.map((k, index) => {\n          return <tr>\n            <td style={{ border: '1px solid lightgrey', width: 200, paddingLeft: 10, backgroundColor: '#eeeeee' }}>{k}</td>\n            <td style={{ border: '1px solid lightgrey', width: 200, paddingLeft: 10 }}>{Array.isArray(data[k]) ?\n              data[k].map(e => <div style={{ margin: 5, padding: 3, borderRadius: 3, backgroundColor: 'lightgray' }}>\n                {e.name}\n              </div>) :\n              data[k]}</td>\n          </tr>\n        })}</table>)\n      }\n\n      const columns = [\n        {\n          title: 'Ticket#',\n          dataIndex: 'id',\n        },\n        {\n          title: 'Request Type',\n          dataIndex: 'change_type',\n        },\n        {\n          title: 'Request Description',\n          key: 'description',\n          render: (record) => {\n            // console.table(record)\n            let data = JSON.parse(JSON.stringify(record))\n            let string = JSON.parse(data.data)\n\n            return <Row>\n              <span>\n                {data.description ? `${data.description} ` : `${data.action}`}\n              </span>\n              <div onClick={() => {\n                setmodalString(`\n                  <b>Action</b> : ${data.action}${' '}<br /><b>Request Type</b> : ${data.change_type}\n                  <div style=\"display: flex; flex-direction: row;\">\n                  <div style=\"flex:1;margin-right: 5px;\"><b>Current Value</b> : ${renderTableData(string.Current)}</div>\n                  <div style=\"flex:1;margin-left: 5px;\"><b>New Value</b>: ${renderTableData(string.New)}</div>\n                  </div>\n                `)\n                setvisible(true)\n              }}><span><a> : details</a></span></div>\n            </Row>\n          }\n        },\n        {\n          title: 'Request ID',\n          dataIndex: 'maker_id',\n        },\n        {\n          title: 'Request Date',\n          // dataIndex: 'requested_date',\n          key: 'requested_date',\n          render: (record) => {\n            let data = JSON.parse(JSON.stringify(record))\n            let date = moment(data.requested_date).format('LLL')\n            return <span>\n              {date}\n            </span>\n          }\n        },\n        {\n          title: 'Action',\n          key: 'action',\n          render: (record) => (\n            <Row gutter={16}>\n              <TcrbPopconfirm title={\"Confirm to Approve !!!\"} onConfirm={() => processPending(\"APPROVE\", record)} >\n                <HoverIcon className=\"gutter-row\" span={6}>\n                  <CheckCircleOutlined height={\"1.5em\"} width={\"1.5em\"} />\n                </HoverIcon>\n              </TcrbPopconfirm>\n              <TcrbPopconfirm title={\"Confirm to Reject !!!\"} onConfirm={() => processPending(\"REJECT\", record)} >\n                <HoverIconReject className=\"gutter-row\" span={6}>\n                  <CloseCircleOutlined height={\"1.5em\"} width={\"1.5em\"} />\n                </HoverIconReject>\n              </TcrbPopconfirm>\n            </Row>\n          ),\n        },\n      ];\n\n      useEffect(() => {\n        // call api\n        const data = {\n          filter: {}\n        }\n        pendingApprovalStore.getPendingApprove(data)\n      }, [])\n\n      useEffect(() => {\n        if (pendingApprovalStore.responseGetPendingApproveList && pendingApprovalStore.responseGetPendingApproveList.length > 0) {\n          addKeyToDataSource(pendingApprovalStore.responseGetPendingApproveList).then((result) => {\n            //businessParametersSetupStore.arrayProductLimit = result\n            setPendingApprovalData(result)\n          })\n        }\n      }, [pendingApprovalStore.responseGetPendingApproveList])\n\n      const processPending = (status, record) => {\n        let data = {\n          allowAction: status,\n          data: record,\n          id: record.id\n        }\n        pendingApprovalStore.setTmpPendingListID(record.id)\n        pendingApprovalStore.processPendingListApprove(data)\n      }\n\n      useEffect(() => {\n        if (pendingApprovalStore.tmpPendingListID && pendingApprovalStore.tmpPendingListID != null) {\n          if (pendingApprovalData && pendingApprovalData.length > 0) {\n            const list_all = JSON.parse(JSON.stringify(pendingApprovalData))\n            const old_data = pendingApprovalStore.tmpPendingListID\n            list_all.map((e, i) => {\n              if (old_data == e.id) {\n                list_all.splice(i, 1)\n              }\n            })\n            setPendingApprovalData(list_all)\n          }\n        }\n      }, [pendingApprovalStore.tmpPendingListID])\n\n      const _onConfirm = () => {\n        setvisible(false)\n      }\n      const _onCancel = () => {\n        setvisible(false)\n      }\n\n      const tableColumns = columns.map(item => ({ ...item }));\n\n      return (\n        <TcrbSpin spinning={pendingApprovalStore.apiLoading} size=\"large\" tip=\"Loading...\" >\n          <Row >\n            <Col span={24}>\n              <Table\n                pagination={{ position: [top, bottom] }}\n                columns={tableColumns}\n                dataSource={pendingApprovalData}\n              // scroll={scroll}\n              />\n              <SimpleModal\n                title={title}\n                // type={modalType}\n                onOk={() => _onConfirm()}\n                onCancel={() => _onCancel()}\n                textCancel={textCancel}\n                textOk={textOk}\n                width={800}\n                modalString={modalString}\n                visible={visible}\n              />\n            </Col>\n          </Row>\n        </TcrbSpin>\n      )\n    }))\n\nexport default withTranslation('common')(PendingApprovals)\n\n"]},"metadata":{},"sourceType":"module"}